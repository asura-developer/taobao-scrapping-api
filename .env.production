# ================================
# CRITICAL: Security - Change All Passwords!
# ================================
MONGO_PASSWORD=CHANGE_THIS_TO_SECURE_PASSWORD_NOW
MONGO_EXPRESS_PASSWORD=CHANGE_THIS_ADMIN_PASSWORD

# ================================
# Server Configuration
# ================================
NODE_ENV=production
PORT=3000

# ================================
# MongoDB Configuration
# ================================
# Constructed automatically in docker-compose, but can override:
# MONGODB_URI=mongodb://admin:your_password@mongodb:27017/taobao_scraper?authSource=admin

# For MongoDB Atlas (cloud alternative):
# MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/taobao_scraper?retryWrites=true&w=majority

MONGODB_POOL_SIZE=10

# ================================
# Puppeteer/Browser Configuration
# ================================
SCRAPER_HEADLESS=true
SCRAPER_TIMEOUT=60000
PUPPETEER_PROTOCOL_TIMEOUT=180000

# Docker optimization - use bundled Chromium
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=false

# Puppeteer Docker args (for stability)
PUPPETEER_ARGS=--no-sandbox,--disable-setuid-sandbox,--disable-dev-shm-usage,--disable-gpu

# ================================
# Scraping Configuration
# ================================
MAX_CONCURRENT_JOBS=2
PAGE_LOAD_DELAY=3000
SCROLL_DELAY=2000
DETAIL_PAGE_DELAY=2000
SCROLL_STEP_DELAY=500
MAX_RETRIES=3

# Auto-scraping settings
AUTO_SCRAPE_DETAILS=true
DETAILS_PER_BATCH=5
DETAILS_BATCH_DELAY=5000

# Quality control
MIN_EXTRACTION_QUALITY=60

# ================================
# Performance & Resource Management
# ================================
# Memory monitoring threshold (MB)
MAX_MEMORY_MB=1800

# Graceful shutdown timeout (milliseconds)
GRACEFUL_SHUTDOWN_TIMEOUT=30000

# ================================
# Security Configuration
# ================================
# CORS - restrict in production!
CORS_ORIGIN=https://yourdomain.com,https://www.yourdomain.com

# Rate limiting
RATE_LIMIT_PER_MIN=60
RATE_LIMIT_WINDOW_MS=60000

# API security (highly recommended)
ENABLE_AUTH=true
API_KEY=GENERATE_SECURE_KEY_HERE_MIN_32_CHARS

# Helmet security headers
ENABLE_HELMET=true

# ================================
# Logging Configuration
# ================================
LOG_LEVEL=info
ENABLE_REQUEST_LOGGING=true
LOG_DIR=/app/logs

# Log rotation
LOG_MAX_SIZE=10m
LOG_MAX_FILES=7

# ================================
# Health & Monitoring
# ================================
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# Enable metrics endpoint
ENABLE_METRICS=true

# ================================
# Network Configuration
# ================================
REQUEST_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=65000

# ================================
# Feature Flags
# ================================
ENABLE_DEBUG_ROUTES=false
ENABLE_MIGRATION_ROUTES=false
ENABLE_DETAILED_ERRORS=false

# Maintenance mode
MAINTENANCE_MODE=false

# ================================
# Docker-specific (handled by compose)
# ================================
# These are set in docker-compose.yml
# SHM_SIZE=2gb
# RESTART_POLICY=unless-stopped